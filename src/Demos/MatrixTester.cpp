//
//  MatrixTester.cpp
//  ConsensusCoreXCode
//
//  Created by Nigel Delaney on 3/7/15.
//  Copyright (c) 2015 Pacific Biosciences. All rights reserved.
//

#include <chrono>
#include <fstream>
#include <iostream>
#include <string>
#include <memory>
#include <numeric>
#include <vector>

#include <ConsensusCore/Read.hpp>
#include <ConsensusCore/Arrow/ArrowConfig.hpp>
#include <ConsensusCore/Arrow/MultiReadMutationScorer.hpp>
#include <ConsensusCore/Arrow/TemplateParameterPair.hpp>


#define ASSERT_EQ(o, e) \
{ \
    auto d = fabs(1 - (o) / (e)); \
    /* std::cout << dif <<std::endl; */ \
    if (!(d < 1e-5)) \
        std::cerr << "failed assert at " __FILE__ ":" << __LINE__ << "! o = " << (o) << ", e = " << (e) << ", d = " << d << std::endl; \
    else \
        std::cerr << "passed test at " __FILE__ ":" << __LINE__ << std::endl; \
}


namespace ConsensusCore {

    using Arrow::ArrowConfig;
    using Arrow::ContextParameters;
    using Arrow::ContextParameterProvider;
    using Arrow::SNR;
    using Arrow::TransitionParameters;

    class MatrixTester
    {
    public:
        int TestMutationScorer();
        int TestMultiReadScorer();
    };

//    void assert(double o, double e) {
//        double dif = fabs(1- o/e);
//        if (!(dif < 1e-5))
//            std::cerr << "failed assert at " __FILE__ ":" << __LINE__ << "! o = " << o << ", e = " << e << std::endl; \
//        else
//            std::cerr << "passed test at " __FILE__ ":" << __LINE__ << std::endl;
//    }

    typedef Arrow::ArrowMultiReadMutationScorer ScorerType;
    typedef typename ScorerType::RecursorType RecursorType;

    ScorerType createScorer(const std::string& tpl, SNR snr) {
        ContextParameters ctxParams(snr);
        Arrow::BandingOptions bo(12.5);
        ArrowConfig qc(ctxParams, bo);
        return ScorerType(qc, tpl);
    }

    void AddReadToScorer(std::string seq, ScorerType& scorer) {
        ArrowSequenceFeatures features(seq);
        ArrowRead r(features, "nameless", "null");
        MappedArrowRead mr(r, FORWARD_STRAND, 0, (int)scorer.Template().length());
        scorer.AddRead(mr);
    }

    int  MatrixTester::TestMutationScorer()
    {
        // A series of tests, all the correct values are derived from the C# code.
        SNR snr(10.0, 7.0, 5.0, 11.0);

        TransitionParameters tp = ContextParameterProvider::GetTransitionParameters("CC", snr);
        // Now look at a small test case
        std::string tpl = "ACGTCGT";
        // Create a mutation scorer to test values
        auto t = createScorer(tpl, snr);
        AddReadToScorer("ACGTACGT", t);

        double score = t.BaselineScore();
        t.DumpAlphas();
        double t_baseline = -4.94222030733063;
        ASSERT_EQ(score, t_baseline); //-4.99600615471328

        //Test a giant version
        std::string longTPL = "GGGCGGCGACCTCGCGGGTTTTCGCTATTTATGAAAATTTTCCGGTTTAAGGCGTTTCCGTTCTTCTTCGTCATAACTTAATGTTTTTATTTAAAATACCCTCTGAAAAGAAAGGAAACGACAGGTGCTGAAAGCGAGCTTTTTGGCCTCTGTCGTTTCCTTTCTCTGTTTTTGTCCGTGGAATGAACAATGGAAGTCAACAAAAAGCAGCTGGCTGACATTTTCGGTGCGAGTATCCGTACCATTCAGAACTGGCAGGAACAGGGAATGCCCGTTCTGCGAGGCGGTGGCAAGGGTAATGAGGTGCTTTATGACTCTGCCGCCGTCATAAAATGGTATGCCGAAAGGGATGCTGAAATTGAGAACGAAAAGCTGCGCCGGGAGGTTGAAGAACTGCGGCAGGCCAGCGAGGCAGATCTCCAGCCAGGAACTATTGAGTACGAACGCCATCGACTTACGCGTGCGCAGGCCGACGCACAGGAACTGAAGAATGCCAGAGACTCCGCTGAAGTGGTGGAAACCGCATTCTGTACTTTCGTGCTGTCGCGGATCGCAGGTGAAATTGCCAGTATTCTCGACGGGCTCCCCCTGTCGGTGCAGCGGCGTTTTCCGGAACTGGAAAACCGACATGTTGATTTCCTGAAACGGGATATCATCAAAGCCATGAACAAAGCAGCCGCGCTGGATGAACTGATACCGGGGTTGCTGAGTGAATATATCGAACAGTCAGGTTAACAGGCTGCGGCATTTTGTCCGCGCCGGGCTTCGCTCACTGTTCAGGCCGGAGCCACAGACCGCCGTTGAATGGGCGGATGCTAATTACTATCTCCCGAAAGAATC";
        std::string long_read = "GGGCGGCGACCTCGCGGGTTTTCGCTATTTCTGAAAATTTTCCGGTTTAAGGCGTTTCCGTTCTTCTTCGTCATAACTTAATGTTTTTATTTAAAATACCCTCTGAAAAGAAAGGAAACGACAGGTGCTGAAAGCGAGCTTTTTGGCCTCTGTCGTTTCCTTTCTCTGTTTTTGTCCGTGGAATGAACAATGGAAGTCAACAAAAAGCAGCTGGCTGACATTTTCGGTGGAGTATCCGTACCATTCAGAACTGGCAGGACAGGGAATGCCCGTTCTGCGAGGCGGTGGCAAGGGTAATGAGGTGCTTTATGACTCTGCCGCCGTCATAAAATGGTATGCCGAAAGGGATGCTGAAATTGAGAACGAATAGCTGCGCCGGGAGGTTGAAGAACTGCGGCAGGCCAGCGAGGCAGATCTCCAGCCAGGAACTATTGAGTACGAACGCCATCGACTTACGCGTGCGCAGGCCGACGCACAGGAACTGAAGAATGCCAGAGACTCCGCTGAAGTGGTGGAAACCGCATTCCCCTGTACTTTCGTGCTGTCGCGGATCGCAGGTGAAATTGCCAGTATTCTCGACGGGCTCCCCCTGTCGGTGCAGCGGCGTTTTCCGGAACTGGAAAACCGACATGTTGATTTCCTGAAACGGGATATCATCAAAGCCATGAACAAAGCAGCCGCGCTGGATGAACTGATACCGGGGTTGCTGAGTGAATATATCGAACAGTCAGGTTAACAGGCTGCGGCATTTTGTCCGCGCCGGGCTTCGCTCACTGTTCAGGCCGGAGCCACAGACCGCCGTTGAACGGATGCTAATTACTATCTCCCGAAAGAATC";
        ScorerType scorer = createScorer(longTPL, snr);

        int nsamp = 200;
        auto startTime = std::chrono::high_resolution_clock::now();
        for (int i = 0; i < nsamp; i++)
        {
            AddReadToScorer(long_read, scorer);
        }
        auto endTime = std::chrono::high_resolution_clock::now();
        auto duration = std::chrono::duration_cast<std::chrono::microseconds>(endTime - startTime).count();
        auto allocEntries = scorer.AllocatedMatrixEntries();
        int maxEntries = (longTPL.size() + 1) * (long_read.size() + 1);
        double avgMemUsage = 0.5 * std::accumulate(allocEntries.begin(), allocEntries.end(), 0) / (nsamp * maxEntries);
        std::cerr << "avg duration (" << nsamp << " samples): " << duration / nsamp << "us" << std::endl;
        std::cerr << "avg mem usage: " << avgMemUsage << std::endl;
        /*
        score = scorer.BaselineScore();
        ASSERT_EQ(score, -131.73248120890264); // This one was not verified in C#

        int maxAllocs = longTPL.size() * long_read.size();
        for (const int allocs : scorer.AllocatedMatrixEntries())
        {
            std::cerr << "allocated entries for tpl(" << longTPL.size() << ") and qry(" << long_read.size() << ") = " << allocs << " / " << maxAllocs << std::endl;
        }
        // */

        // now let's check really short things
        {
            // default
            ScorerType t_ = createScorer("ACT", snr);
            AddReadToScorer("ACT", t_);
            // test a deletion
            ScorerType t0 = createScorer("ACGT", snr);
            AddReadToScorer("ACT", t0);
            Mutation mL(MutationType::DELETION, 2, '-');
            ASSERT_EQ(t_.BaselineScore(), t0.BaselineScore() + t0.Score(mL));
            std::vector<Mutation> muts = { mL };
            t0.ApplyMutations(muts);
            ASSERT_EQ(t_.BaselineScore(), t0.BaselineScore());
        }

        // Now let's check deletion times
        int i=0;
        for(; i< 1;i++) {
            Mutation mL(MutationType::DELETION, 755, '-');
            score = scorer.Score(mL) / nsamp;
            ASSERT_EQ(score, -4.039538);
        }

        // Check the CC Context
        ScorerType t2 = createScorer(tpl, snr);
        AddReadToScorer("ACCTCGT", t2);
        double score2 = t2.BaselineScore();
        ASSERT_EQ(score2, -6.17329812914413);


        i=0;
        for(;i<1;i++) {
        // Test an insertion mutation
        Mutation m(MutationType::INSERTION, 4, 'A');
        auto new_score = t.Score(m);
        ASSERT_EQ(new_score, (-0.584415070238446 - t_baseline));


        // Now get the same value by mutating the original template
        Mutation m2(MutationType::SUBSTITUTION, 2, 'C');
        auto new_score2 = t.Score(m2);
        ASSERT_EQ(new_score2, (-10.4362503093273 - t_baseline));

        // Test deletion near the end (goes through link/alpha beta path).
        Mutation m3(MutationType::DELETION, 4,'-');
        auto score3 = t.Score(m3);
        ASSERT_EQ(score3, (-9.89216068954291 - t_baseline));

        // Test a deletion of the very last base.
        Mutation m4(MutationType::DELETION, 6, '-');
        auto score4 = t.Score(m4);
        ASSERT_EQ(score4, (-15.6788158527151 - t_baseline));

        // Test an insertion at the very last base
        // This is very poorly defined behavior so I am ditching this.
        //Mutation m5(MutationType::INSERTION, 7, 'T');
        //auto score5 = t.Score(m5);
        //ASSERT_EQ(score5, -8.99810225167093 - t_baseline);

        // Test a deletion of the first base
        Mutation m6(MutationType::DELETION, 0, '-');
        auto score6 = t.Score(m6);
        ASSERT_EQ(score6, (-16.6208180854335 - t_baseline));

        //return 0;
       // Test an insertion at the first base
        // Again bad vehavior wiht ends pinned, so going to tich this
        //Mutation m7(MutationType::INSERTION, 0, 'A');
        //auto score7 = t.Score(m7);
        //ASSERT_EQ(score7, (-7.51178602234865 - t_baseline));


        // Substitution in middle mutations to test link alpha-beta
        Mutation m8(MutationType::SUBSTITUTION, 4, 'A');
        auto score8 = t.Score(m8);
        ASSERT_EQ(score8, (-5.23558996122357 - t_baseline));

        // Insertion in middle to test link alpha-beta
        Mutation m9(MutationType::INSERTION, 4, 'G');
        auto score9 = t.Score(m9);
        ASSERT_EQ(score9, (-6.71553495654471 - t_baseline));
        }
        std::cout << "Finished!" << i << std::endl;
        return 0;
    }

    ArrowRead MakeRead(const std::string& name, const std::string& seq)
    {
        ArrowSequenceFeatures features(seq);
        return ArrowRead(features, name, "null");
    }

    int MatrixTester::TestMultiReadScorer() {
        std::string temp = "AGAGAGATAGCTACTAGTCCTCAGCAAGCTTGATCACACTATATGCGAGCGCGATAGATCGCTCTGCATCGTCACGATGTGTGTATATGACTGAGAGTCATACTATCTCTGCTACGCTCGACGTAGCGCTCATGTCGTCTAGTATGCGTGAGACGACGTAGCAGATACATGAGTGACAGACTCAGCAGTGCGCACAGTCACAGCTGTAGCATCGTACTCTACT";
        SNR snr(15.4944181442261,8.78859329223633,13.521107673645,14.9640893936157);
        ScorerType scorer = createScorer(temp, snr);
        ArrowRead r1 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/19492_19674 RQ=0.848","GAGATACGATGCTACAGGGCTGTGACTGTGCGCACTGGCATGAGATCTGTCACTCCTAATGGTGTATCTTGCTACGCTTCGTACTCTCAGCGCAATACTAGGAACGACAATTGAGCGCGTTACGTCGAGCGTAGCAAGAGGATAGTATGACTCTCAGTCAATAACGACGACAGTTCGGAACG");
        MappedArrowRead mr1(r1, StrandEnum::REVERSE_STRAND, 68, 218, false, false );
        auto result1 = scorer.AddRead(mr1, 1.0);
        ArrowRead r2 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/18859_19111 RQ=0.848","GAAGTACGTATTGCTACAGCTAGATGGACTGTGCGCACTGCTGAGTCGTGTCACTCCATGTATCTGCTAACCGCTCGTTCTCACGCATGGACTAGACGACATGAGCCGCTAACGTCGAGCGTCAGCGAGAGATAGTATGACTCTCAATGTCATATGACACACATCGGTGACGAGGTGCATGAGCGATCCTATCGCGCTCAGCATATAGTGGTGGATCAAGCCTTGCCGTGAGGACTAGTAGGCTTCTCTCTC");
        MappedArrowRead mr2(r2, StrandEnum::REVERSE_STRAND, 0, 218, false, true );
        auto result2 = scorer.AddRead(mr2, 1.0);
        ArrowRead r3 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/9514_9553 RQ=0.848","TAGAGTAGATGTTAGTCAGCTGTGACTGTGCGCACTGCT");
        MappedArrowRead mr3(r3, StrandEnum::FORWARD_STRAND, 169, 205, false, false );
        auto result3 = scorer.AddRead(mr3, 1.0);
        ArrowRead r4 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/16323_16580 RQ=0.848","AGTAGAAGTACTGATGCTACAGCTGCTGACTGTGCGCACTGCTTGAGTCTGTCACTCTATGTATCTGCTACGGTCGTCTCACGCATACTAGAAACGAGCATTGAAAGCGCTACGTGGTCGTAGCGTAGCAGACGAGATAGTATGACTCTACAGTCATAGGTACACACATCGTCGACGATGCCCAGAGCGATCGTAATCGGCGCTCCGAGCATATAGATGTGATCAGCATTGCTGAGGACTAGGTAGCTTCTTCTCTC");
        MappedArrowRead mr4(r4, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result4 = scorer.AddRead(mr4, 1.0);
        ArrowRead r5 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/15332_15587 RQ=0.848","CAGAGAGAGGAAGCGTACTAGTTCCTCATGCAAGCTTGATCCAACGATCTATATGCGCAGCGCGTATATGAGTTCGCTCTGCATCGTCCACGATTGTTGGTGTATAATATGACTGAAGAGGTCATACATATCTCCTGCCTACGCTCGACGTAGCGCTCATGTCGTCCTATATGGCGGTGAGACGACGTAGCAGGATACATGAGCTGAAGACTCAGCATGTGCGCAGCAGTCAGCAGCTGTAGCATGCGTACTTAC");
        MappedArrowRead mr5(r5, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result5 = scorer.AddRead(mr5, 1.0);
        ArrowRead r6 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/18204_18466 RQ=0.848","AGTAGCAGTACGATGCTACAGGCTGTGACCTGGTCGCACTGCTGTAGATTCTGTCACTGCATGTTCTGGCTACGGTCGTCTCACGCAATGACTAGAGGACTGACATGAGCGCTTACGTCGAGCGTAGCAGAGATAGTATGTTAACTCTCAGTCATATACAACACATTTTCGCTGACGAGTGCAAGAGCGATGCTAATGCGCGGAGCCTCGCAAATATATGTGTTAGATCAACGCTTGCTGAGGATCTAGTAGCTTCTCTCTC");
        MappedArrowRead mr6(r6, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result6 = scorer.AddRead(mr6, 1.0);
        ArrowRead r7 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/15692_15951 RQ=0.848","GAGTACGATGGCACAGCTGTGACTGTGCGCAATGTGCGTGTTAGTCCTGGTCAGCTCATGTATCTGCTACGGTCGGTCTCGACGCATACTAGACGACATGAATGGCGATACGTCGCGAGCGTAAAATAGAGATTAGTATGACTCGTCAGTCAATATTACAACACGCACTCGTGGACGATGCACGAGCTGGGATCTATCGCGCTCGGACATTATAGTGTGATCAATAGCTTTGACTAGGACTAGTAGCTTTTCTCATCTC");
        MappedArrowRead mr7(r7, StrandEnum::REVERSE_STRAND, 0, 218, false, true );
        auto result7 = scorer.AddRead(mr7, 1.0);
        ArrowRead r8 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/8795_8817 RQ=0.848","AGCTGTGACTGTGCAGCACTGC");
        MappedArrowRead mr8(r8, StrandEnum::FORWARD_STRAND, 186, 204, false, false );
        auto result8 = scorer.AddRead(mr8, 1.0);
        ArrowRead r9 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/2226_2455 RQ=0.848","AGAGAGAAAGAAGCTCCTCAGTTCCTCAGCAAGCTTGATCAACTATATGCGAGCGCGATAGATCGGCCTCTGCATCGTCACGAATGTTGTGTATATGAACTGAGAGTCATACTATCTCATGCTACGCCTCGACGTAGCGCTCATGTCGTCTCAAGTTATGGCGTGAGAGCGACTGTTTTAGCAAGATACATGAGTGACAGACTCAGCAATGTGCGGCACCCCGCTCACA");
        MappedArrowRead mr9(r9, StrandEnum::FORWARD_STRAND, 0, 202, true, false );
        auto result9 = scorer.AddRead(mr9, 1.0);
        ArrowRead r10 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/16613_16860 RQ=0.848","AGAGAGAAGCTACTGAGTCTCAGCAAGGCTTGTCAACCTACTAATATGCGAGCGCGTGATAGATCGCTTCTGGCATCGTCAACGATGTGTGTATACTGACTGAGAGTCATACTATCTCTGAACTGACGCTCGACGTAGCGCTCATGTCGTCTAGTATGCGTGATGACGACGTAGGCAGACATACAGTGAGTGAATGAGCAGACTCAGCAGTTGCGCACAGTCACAGCGTGTAGCAATCGTACTCTAC");
        MappedArrowRead mr10(r10, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result10 = scorer.AddRead(mr10, 1.0);
        ArrowRead r11 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/20400_20644 RQ=0.848","AGAGAAGAGAAAGCTACTAGTCCTCAGCAAGGCTTGATCACACTATATGCGAGAGCCGATAGATCGCTCTGCATCGGTCACGGATGTGTGTATATGACTGAGAGTCATACTATCTCTGGCTACGGCTCGACGTAGCGGCTCATGTCGTCGTAGTATGGCGTGGAAGAAACGACGTAGCAGATACATGATGACAGTACTCAGCAGTGCGACACAAGTCACAGCTGTAGCATCGTAAACTAGCTAC");
        MappedArrowRead mr11(r11, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result11 = scorer.AddRead(mr11, 1.0);
        ArrowRead r12 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/6753_6994 RQ=0.848","AGTAGAGTACGAATTGCTACAGCTGTGACTGTGCGCACTGCTGAGCTCTGTCACTCATGTATCTGCTACGTCGTTCTCACGCATACTAGACGACATGAGCGCACGTCGAGCGTAGCGAGAGATAGTATGACTCTCAAGTCCTATACACACATTCGTGACGATGCCCAGAGCGATCTATATCGGGCTCGGCATATAGTGTGGATCAAAGCTTTGCTGAGGAACTAGTAAGCTTTTCTCTCTC");
        MappedArrowRead mr12(r12, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result12 = scorer.AddRead(mr12, 1.0);
        ArrowRead r13 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/7969_8009 RQ=0.848","ATGGGCAGTGCGCACAGTTCACAGCCTGTAGCATCGTACT");
        MappedArrowRead mr13(r13, StrandEnum::REVERSE_STRAND, 170, 204, false, false );
        auto result13 = scorer.AddRead(mr13, 1.0);
        ArrowRead r14 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/21345_21579 RQ=0.848","AGTAGAAGTTACGATGCTACAGCTGTGACTGTGCGCACTGCTGATCCTGTCACTCAATGTATCTGCTACGTCGTCTCACGCATACTAAGACGACAATGAGCGCTACGTCGAGCGTAGCAGAGAATAGTAATGACCTCTCAGGTCATATACACACATCGTGACGAATGCAGAGCGATCTATCGCGCTCGCATATAGTGTGATCAAGCTTGCTGAGGACTAGTAGCTTCTTCTCTC");
        MappedArrowRead mr14(r14, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result14 = scorer.AddRead(mr14, 1.0);
        ArrowRead r15 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/3458_3698 RQ=0.848","AGAGAGAGAAAGCACTAGTCCTCAGCAAGCTTGATAACACTAGTATGCGAGCGCGATAAAAGAGGATTCGCTCTGCATGCGTCACGAAAATGTGTGTATATGACTGAAGAGTCAATACTATCTCTGCTAACGCTGCGACGTAAGCGCTCATTCGTCTAGTTATGCGTGAGACGACGTAGCAGATACATGAGTGCAGACTCAGCTAGTGCGCCAGTCACAGCTTGTAGCATCGTACTCTAC");
        MappedArrowRead mr15(r15, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result15 = scorer.AddRead(mr15, 1.0);
        ArrowRead r16 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/6423_6662 RQ=0.848","AGAGGAGAGAAAGCTACTAGTCCCTGCAGCAAAGCTTGATCAGAACTATTGCGAGCGCGATAGATCGCTCGCATCGTCACGATGTGTTTGTATATGACTGAGAAGTCCATACTATGCTCTGCTACGCTCGGACGTAAGCGCTTGCATGTCCGTCTTAGTCATGAGTGAGACGAACGTAGCAAGATACATGAGTGACAGACTCAGCAGTGTGCACAGTCACAGCTGTAGCATGTACTCTA");
        MappedArrowRead mr16(r16, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result16 = scorer.AddRead(mr16, 1.0);
        ArrowRead r17 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/17240_17485 RQ=0.848","AGAGAGAGAAAGCTACTTAGTCTCAGCAAGCTTGATCACACTTGATATGCGAGCGCGATAGAGTGCTTCTGGCAATCGTCAACGATGTGTGTATGATGACTGAGAGTCAAACTAATCTCTGCTCAACGCTTCGAGCGTAGCGCTCGCATGTCGTCTAGTATGTCGTGAGACGACGTAGCGAGATACATGAGTGACAGACTCAGCAGTGCGCGCACAGTCACAGGCTGTAGCATCGTACTTTCTAC");
        MappedArrowRead mr17(r17, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result17 = scorer.AddRead(mr17, 1.0);
        ArrowRead r18 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/17861_18106 RQ=0.848","AGAGAGAGAAGCTACTAGTCCGGTCAGCAAGCTTGATCACACTGATAAGTCGAGGCGCGATAGATCGCTTGCCTGCGACTCGTTCACGATGTGTGTATATTGAATGAGAAGTCATACTATCTCTGCTACGGCTCGACCGATAGCGCTGCATGTCGTCTAGTATGGTGAGACGACGTAGCAGATACATGAGTGACAAGACTCAGCATGTGCGAACAGTCGCACAGCTGTAGCATCGTATCTCTACC");
        MappedArrowRead mr18(r18, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result18 = scorer.AddRead(mr18, 1.0);
        ArrowRead r19 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/17577_17832 RQ=0.848","AAGTAGAGTACGATTGCTACAGCTGTGACTGTGCGCACTGCTGAGTAGTTCTGTCACTTGGCATGTATCTGCTAGTACAGTCGTCTCACGCATACTAGGACGAACATGGAGGCCGCTGAACGTCGAGCGTAGGCCGAGAATAGTTGACTCTCGAGTCATTTACACACATCGTGACGATGCAAAGAGCGATCTAGTCGGCGCTCGCATATATGTGTGAATGGCAGCTTGCTGAAGGATAGTAGCATTCCTCTCTCT");
        MappedArrowRead mr19(r19, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result19 = scorer.AddRead(mr19, 1.0);
        ArrowRead r20 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/16968_17208 RQ=0.848","GTAGACGTACGAATGCATACAGTGTGACTGTGCGCCACTGCTGATCTGTCACTCATAGTATCTGCTACGGTCGTCTCACGCTGATACTAAGAGAACGACCATGAGCGCTATGCGTCGAGCGTTAGCAGAGATAGTATAGACTTCAGTCATATACACACATCGTGACGATGCAGGAAGCGATCTATCGCGCTCGCATTATGCGTGTGATCAAGCTTGCTGAGGACTAGTAGCTCGTCTCTC");
        MappedArrowRead mr20(r20, StrandEnum::REVERSE_STRAND, 0, 221, false, true );
        auto result20 = scorer.AddRead(mr20, 1.0);
        ArrowRead r21 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/8636_8676 RQ=0.848","ATGCAGTGCGCAGCTCGTCACAGCTGTAGCATCGTACTCT");
        MappedArrowRead mr21(r21, StrandEnum::REVERSE_STRAND, 169, 204, false, false );
        auto result21 = scorer.AddRead(mr21, 1.0);
        ArrowRead r22 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/1324_1576 RQ=0.848","AGTAGAGTACCGACTGCTACAGCTGTGCATGTGCGGCCTGTGAGCTCTGTCCACTCCATATGTATCTGCTTAACGTCGTCTCACCGCATACCCTAGACCGACATGAGCGCGCTACGGTCGAGCGTAGCACCGACGATATCCGTATGAACTCTCAGTCATTACCACACCACTCGTGACGATTGCCAGAGCGATCTATCGCGCTCGCAATATAGTGGTGATCAAGCTTGCTGAGACTTAGTAGCTTCTCTCTGC");
        MappedArrowRead mr22(r22, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result22 = scorer.AddRead(mr22, 1.0);
        ArrowRead r23 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/6157_6393 RQ=0.848","ATAGGAGTAGGCGATGCTATCAGCTGTGACTTGTGCGCACTGCTGAGTCCTGTCACTCATGTATCTGCTACGTCGTCTGCACGTCATACTAGACGACATGAGCGCTACGTCGAGCCGTAAGCAGAGATAGTATGACTCTCAGTCAATATTACACACATCGGACGAGCAGAGCGAATCTATTCGCGCTCGCATATAGTGGTGATCAAGCTTGCTGGGATAGTAGCTTTTTCTGTCTC");
        MappedArrowRead mr23(r23, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result23 = scorer.AddRead(mr23, 1.0);
        ArrowRead r24 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/15983_16224 RQ=0.848","AGAGAGAGAGAGCGTAGCTAGTCCTGCAGCAAAGCTGATCACACTAATAATGCGAGCGCGATAGTCGCTCGATGCACTGCGTCACGATGTGTGTATATGACCTGAAGCAGTCATACTATCTCTGCTACGCTCGACGTAGCGCTCATGGTCGTCTAGTATGCGTGAGAACGACGTAGCAGATACATGAAGTGACAGACTCAGCAGTGCGCACAGTCACAGGCCTGTAGCAATCGTACTCTAC");
        MappedArrowRead mr24(r24, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result24 = scorer.AddRead(mr24, 1.0);
        ArrowRead r25 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/1951_2192 RQ=0.848","AGTAGAGTACGAGATGCTACAGCTGTGACTGTGCCGCACTGCTCGATGTCCTGTCAAATCATGTATCCTGCTACATTCGTCGTCCACGCATGACTTAAGATCGACATGCAGCGCTACGTCGAGCGCTAGAAGATAGTATGACCTCTCAGTCATATACAACAACATCGTGACGATGCTACGAGCGATCTACTGCGCTTCGCATCATACGTGTCGATCAAGCTTTGACTAGTAGCTCTCTCTC");
        MappedArrowRead mr25(r25, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result25 = scorer.AddRead(mr25, 1.0);
        ArrowRead r26 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/12671_12707 RQ=0.848","ACAGTGCGCATACAGTCACAGCTGTAGCATGCCGTG");
        MappedArrowRead mr26(r26, StrandEnum::REVERSE_STRAND, 169, 204, false, false );
        auto result26 = scorer.AddRead(mr26, 1.0);
        ArrowRead r27 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/20743_20984 RQ=0.848","AGTAAGAGTACGATGCATAGGCTTGACTGTGCGCACTGTGCTGAGTCTGTCACATAGTTTCTGCTACGCTGTCTCACGGCATAACTAGTACGAGCATGAGCGCCTACGTCGAGCGTAGCAGAGAAGTAATGACTCTCAGTCATAACTACACGACATCGTGACGATGCCAGCAGCGAATTATCGCGCTTCGGGCATAGTAGTGTTGATCAAAGCTTGCTGAGGACTAGTAGTCTTCTCTCTC");
        MappedArrowRead mr27(r27, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result27 = scorer.AddRead(mr27, 1.0);
        ArrowRead r28 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/3802_4037 RQ=0.848","AGAGAGTACGATGCTACAAGCTGTGACTGTGGCGCACTGCTGAGATCTGTCACTCATCGTATCTGCTACGTCGTCTCACGCATAACTAGACACATGAGCGTCTAGCGTCGAGGGCGTAGCAGAGATAGTATGACTCTGCAGTCATATCAGCACATCGTGAGCGATGCAGAGCGCCTCTATCGGCGCTCGCATAATAGTGTGATCAAGCTTGCTGGAGGACTAGTAGCTTCTTCTC");
        MappedArrowRead mr28(r28, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result28 = scorer.AddRead(mr28, 1.0);
        ArrowRead r29 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/10553_10784 RQ=0.848","AGAGAGAGAAGCTACTAGTCCTCAGCAGCTTGATCAACACTATATGCGAGCGCGATAGATCGCTCTGCATCGTCAGATGTGTGTTATATGACTGAGAGTCATACTATCTCTGCTACGCCTCGAGTAGGCGCCTCATGTCGTCTAGTAATGCGTGAGACGAACGTAAGCACAGATACATGAGTGACAGACTCAGCAGTGCGCACCAGTCACAGCTGTAGCATCGTACTCTAC");
        MappedArrowRead mr29(r29, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result29 = scorer.AddRead(mr29, 1.0);
        ArrowRead r30 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/18502_18748 RQ=0.848","AGAGAGAGCTACTAGTCCTCAAGCCGTCTTGAGTCAACACTCATGCCGATGCGATGCGCGATAAGATCGCATCGCATTTTCGTCACGGATGTGTGTTATATGACTGAGAGTCATACTTCTCGTGGCTAGCTCGACGGTAGCGCTGCATGTCCGTCTAGTATTGCGTGAGAAAGACGTAAGCCAGGATACAGTGAGTGACAGACTCAGGGCAGCTGCGCACAGTCACAGCTGTATGCATCGGTGGAT");
        MappedArrowRead mr30(r30, StrandEnum::FORWARD_STRAND, 0, 218, true, false );
        auto result30 = scorer.AddRead(mr30, 1.0);
        ArrowRead r31 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/20131_20370 RQ=0.848","AGTAAACAGATGTACAGCCTTCGCTGTGACTGTGGCACTGTGAGTCTGTCAACTCATGTATCTGCTACGTCGTCTGCACGCATACCTAGAACGACATTGACAGCGGCTACGTCGACGTAGCAGAGAATAGGTATGACTCTCAGGTCATATACCAGCATCGTGACGATGCAGAGCGATCTATACGGCGTGCATATAGTGTGATCAAGCTTGCTGAGAGACTAGCTAGATTCTCTCTAAAT");
        MappedArrowRead mr31(r31, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result31 = scorer.AddRead(mr31, 1.0);
        ArrowRead r32 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/4654_4882 RQ=0.848","AGAGAGAGAAGCTTACTAGTCCTCAGCAAAGCCTTTGTCACAACTATATTGCGACGCGATAGATCGCTCTGCATCGTGCACGATGGTGTGTATATGACTGAGAGTCATACTATCTTGCTACGCTCGACGTAGCGCTCATGTCGTCTAGTAGGTGAGACGACGTTAAGCAGATACATGAGTGACAGACTCAGCAGTGCGCACAGTCACAGCTGTACATTCGTACTCTAC");
        MappedArrowRead mr32(r32, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result32 = scorer.AddRead(mr32, 1.0);
        ArrowRead r33 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/5573_5804 RQ=0.848","AGTAGAGTACGATGCCTACAGCTGTGACTGTGCGCACTGCTGAGTCTGTCTACTCATGTATCTGCTACGTCGTCTCAACGCATACTAGAGACATGAGGCGCTACGTCGAGCGTAGCAGAGATAGTAATGACTCCTGCAGTCATATACACCAACATCGTTACGATGCCAGAGCGATTATCGGCGCTCGCATATAGTGTGTCAGCTTGCTTGAGGACTAGTAGCTTCTCTCTC");
        MappedArrowRead mr33(r33, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result33 = scorer.AddRead(mr33, 1.0);
        ArrowRead r34 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/5243_5464 RQ=0.848","AGAGAGAGAAGCTACTAAGTCTCAGCAAGCTTGATGCACACTATATGCGAGCGCGATAGATCGTCTGCATCGTCAGATGTGTGTATAATGACTGAGAAGTCATACTATCTCTGCTACGCTCGACGTTAGCGCTCATTGTCGTCTAGTATGCGTGAACGACGTAGGCAGATACATGAGTGACAGACTCAGCAGTGCGCAAGTCACAGCTGTAGCATCGTACT");
        MappedArrowRead mr34(r34, StrandEnum::FORWARD_STRAND, 0, 218, true, false );
        auto result34 = scorer.AddRead(mr34, 1.0);
        ArrowRead r35 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/4066_4296 RQ=0.848","AGAGAGAAGAAGCTACTAGTCCTCAGCAAGCTTGATCACACTATATGCGAGCGCGATAGATCGCTCTGGCATCGTCACGATGTGTGTATAATGAACTGAGAGTTCATATACTCTGCTAACGCTGCGACGTAGCGCTCATGTCGTCCTCAGTATCCGTGAAGACGACGTGCAGATACATGAGTGACAGACTCAGCATGCGCACAGTCACAGCTGTAGCATCGGTACTCTAC");
        MappedArrowRead mr35(r35, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result35 = scorer.AddRead(mr35, 1.0);
        ArrowRead r36 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/10882_11119 RQ=0.848","AAGTAGAGTATGCGATGCTACAGCTGTGACTGTGCGCACTGCTGAGTCTGTCACTCATGTTCTGCTACGTCCGTCTCACGCATACTAAGCGAATGAGCGCTACGTCGACGTAGCAGAGATAGTAATGACTCTCAGTCAATTACACACATCCGTGACGATGGCAGAGCGATCTATCGCGCTGCATATAGTGTGAATCCAAGCTTTGCTGGAGTGACTAGTGATAGCTATATTTCTCTC");
        MappedArrowRead mr36(r36, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result36 = scorer.AddRead(mr36, 1.0);
        ArrowRead r37 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/4395_4623 RQ=0.848","AGTAGAGTACGATGCTACAGCTGGTGACTGTGGCGCACTGCTGAGTCCCTGTCACTCATGTATCTGCTACGGTCGTCTCCACGCATAGACGACATGAGCGCTACGGTCGAAGCGTAGCAGAGATAGTATGACTCTCAGTCATATACACACATCGTGACGATGCAAGAGCGATCCTATTCGCGCTCGCATATAGTGTGATCAGCTTGCTGAGGACTATAGCTCTCTCTC");
        MappedArrowRead mr37(r37, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result37 = scorer.AddRead(mr37, 1.0);
        ArrowRead r38 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/1608_1846 RQ=0.848","AGAGAGAAGCTACCTAGTCCTCAGCAAGCTTTGATGCAGCAACTATATGCGAGCGCGAATAGATCGCTCTGCATTCGTCACGCCTGTGTGTATTGACTGAGAAAGTCATACTATCTGCTGCTACGGCTCGACGTAGGCGCTCATGTCGTCGCTAGTATGCGTGAGACGACGTAAGAGATACATGAGTGACAGACTCAGGCAGTACGCGCACAGTCACAGCTGTAGCATCGTACTCTAC");
        MappedArrowRead mr38(r38, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result38 = scorer.AddRead(mr38, 1.0);
        ArrowRead r39 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/4978_5211 RQ=0.848","AGTAGAAGTACGATGCTTACAGCTGTGACTGGGCGCAACTGCTGAGATCTGTCACTCCATGTATCTGCTACGTCGTTCACGCATACTAACGACATGAGCGCTACGTCGAGCGTGTAGCAGGAGATAGTAAATGCACTCTCAGTCATATACCACATCGTGAACGATGCAGAGCGATCTATCTGGCTCGCATATAGTGTGACAAAGCCTTGCTGAGGACTAGTAGCTTCTCTCTC");
        MappedArrowRead mr39(r39, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result39 = scorer.AddRead(mr39, 1.0);
        ArrowRead r40 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/19787_20017 RQ=0.848","AGAGAGAGAGCTACTGTCCTCAGCAAGCTTGATCACACTATATGGCGAGCGCGCGATAGAATCGCTCTGCATCGTCCAGATTGTGTGTAGTTATGACTGAGAGTCAGTACTATCTCTGCTCGCTTCGACGTGCGGCTCATGTCGTCTAGTAAATGGCGGTGAGACTGACGTAAAGCAGGATAACATGAGTTGACAAGACCAGCAGTGCCGCAAGTCAGCAGCTGTAGCAT");
        MappedArrowRead mr40(r40, StrandEnum::FORWARD_STRAND, 0, 212, true, false );
        auto result40 = scorer.AddRead(mr40, 1.0);
        ArrowRead r41 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/11156_11400 RQ=0.848","AGAGCGTAGATAGCTACTAGTCTCAGCAAGCTTTGTATGGCACAGCTGATATGCGAAGCGGCGATAGTATATATCTCACGATGTGTGTATAAGTGACGTGAGGAGCTGCTCACATACTATCTCTGCTACGCTCGACGCTAGGCGCTCACTGTCGTCTAGTATGCGTTGAAAGAACGACGTAGGCAGATACATGATGACAGACTCAGCAGTGCGCACAGTCACAGCTGTAGCATCGTTACTCTAC");
        MappedArrowRead mr41(r41, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result41 = scorer.AddRead(mr41, 1.0);
        ArrowRead r42 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/5838_6061 RQ=0.848","AGAGAGAAGCTACTAGTCCTTCAGCAAGCTTGATACACTATATGCGAGCGCGATAGATCGCTCTGCATCGTCACGATGTGTGTATATGACTGAGAGTCATACTATCTCTGCTACGCTGACGTAGGCTCAATGTCGTCTAGTATTGCGTGAGACGACGTAGCAGATACATGAGTGACAGACTCAGTCAGTGCGCACAGTCACAGCTGTCGCATCGTACTCTAGC");
        MappedArrowRead mr42(r42, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result42 = scorer.AddRead(mr42, 1.0);
        ArrowRead r43 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/21019_21250 RQ=0.848","AGAGAGAGAAGCTACTAGTGCCTCAGCAAGCTTGATCAGCACATTGCGAGCGCGGATAGATGCGCGTCTCATCGTCACGATGGCTGTGTATATCTACTGAAGAGTCCATACTATCCTCTGCTAACGCTCGCGTAGCGCTCAGTCGTCTAGTATGCGTGAGACGAAACGTAGCAGATACATGAGTGACAGACTCAGCTGCGCAACAGTCCACAGCTGTAGCATCGACTCTAC");
        MappedArrowRead mr43(r43, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result43 = scorer.AddRead(mr43, 1.0);
        ArrowRead r44 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/2572_2817 RQ=0.848","AGTAGAGTACGATGCTACAGCTGTGACTGTCCGCGCACTGCTGACGTCTGTCACTCAATGTATCTGCCTACGGTCGTCTCATCGCATACTAACGACATGAGCCGCCTACGAGTCGAGCGTACGCTAGAGATAGTATGCTGCTCAGTCATATACACACATCGTCGACGATGCCCAGAGCGATTCTAATCGCGCCATCGCACTATAGTGTGATCAAGCTTGCTGAGGACTAGTAGGCTTTCTCTCTC");
        MappedArrowRead mr44(r44, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result44 = scorer.AddRead(mr44, 1.0);
        ArrowRead r45 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/19143_19381 RQ=0.848","AGAGAGAGCTACTAGTATCTCAGAAGCTTGATCACAACTATATGCGAGACGCGATGATCGCTCTGCATTCGTCCACGATGGTGTGTATATGGACGTGAGAGTCATCACTATTCTCTGCTACGGCTCGGACGTAGCGCTCAAATGTCGTCGAGTATGCGTGAGAACGACGTTAGCAGATACATGAGTGACAGAGCTCAGGCAGTGCGCACAGTCACAGCTGTAAGCATCGTACTCTGAC");
        MappedArrowRead mr45(r45, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result45 = scorer.AddRead(mr45, 1.0);
        ArrowRead r46 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/11497_11734 RQ=0.848","AGTAGAGTACGATGCTAAGCTGTGACTGTGCGCAACTGCGAGTCTGTCAACTCATGTATCTGCTAACGTCGTCTCACGCATACTAGACGACATGAGCCGCTACGTCGAGCGTAGCAGAGATAGGGTATGACTCGTGCAGTCATATACACATCGATGACGAATTGGCAGAGGCGATCGTACGGTCGGCTCACGCATATATGAAATCATGCTTGCTGGAAGGACTAGTAGCACTTTCTC");
        MappedArrowRead mr46(r46, StrandEnum::REVERSE_STRAND, 0, 222, false, true );
        auto result46 = scorer.AddRead(mr46, 1.0);
        ArrowRead r47 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/21610_21833 RQ=0.848","AGAGAGGAAGCCTACTATCCTCAGGCAAGCTTGATCACAACTATATGCGAGCGCGATAGATCGCTTGCATGTCGATGTGTGTATATGACTGAGAGTCATACATCTCTTGCTACCTCGACGTGCGGCTCGATGTCGTCTAGTATGGCGTAGACGACGTAGCAGAATACATGAGTGACAACTGCAGCAGTGCGCACGTGCCACAGCTGTAGCATCGTAACTCTAC");
        MappedArrowRead mr47(r47, StrandEnum::FORWARD_STRAND, 0, 222, true, false );
        auto result47 = scorer.AddRead(mr47, 1.0);
        ArrowRead r48 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/2853_3080 RQ=0.848","AGCAGAGAGAAAGCTACCTAGTCCTGCAACAAGCTCTGATCACACTATATCGCCCAGCGCGATAGATCGCTCTGCTATCGTCCACGATGTGTTATACTGACTTGAGAGTCCATACTATCTCTGCTCCGCTCGAGCGTAGCGCTCATGTCGTCTAGTATGCGTAGACGACGTAGGCAGATAACATGAGTGACAGACTCAGCAGTGTCGCCACAGTCCAGCCAGCTGTG");
        MappedArrowRead mr48(r48, StrandEnum::FORWARD_STRAND, 0, 209, true, false );
        auto result48 = scorer.AddRead(mr48, 1.0);
        ArrowRead r49 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/3207_3426 RQ=0.848","CACGCTCGCTCGCACTCGCTCGCGCACTGCTGAGTCTGTCACTCATGTAATCTGCTACGTCGTCTCACGCATACTAGACGACATGATGCGCTACGTCGAAGCGTAGCAGAGATAGTATGACTCTCAGTTCATATACACACATCGTGACGATGGCAGAGCGATCTATCGCGCTCGCATATAGTGTGATCAAGCTTGCTGAGGACTAGTAGCTTCTCTCTC");
        MappedArrowRead mr49(r49, StrandEnum::REVERSE_STRAND, 0, 205, false, true );
        auto result49 = scorer.AddRead(mr49, 1.0);
        ArrowRead r50 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/15022_15119 RQ=0.848","ATATGATTGATGCGCACATTAGTAGTCTGTCACTCAGTTAGTGATCTGCGCTACGGGTTTTCGTCTCACGCTCGATATATATCGCTGAGAAGTGACG");
        MappedArrowRead mr50(r50, StrandEnum::REVERSE_STRAND, 112, 206, false, false );
        auto result50 = scorer.AddRead(mr50, 1.0);
        ArrowRead r51 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/12209_12224 RQ=0.848","GCCACTGACTGGAGA");
        MappedArrowRead mr51(r51, StrandEnum::FORWARD_STRAND, 189, 203, false, false );
        auto result51 = scorer.AddRead(mr51, 1.0);
        ArrowRead r52 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/7070_7301 RQ=0.848","TATATTCGAGAAGGTTCATGCGATGCGTGCGATAGATCGCCTTCTGCATCGTCCAAGATGTTGTGTATATGACTGAGAAGTCAATACTATCTTCTGCTACGCTCGACGCTAGCAGCGTCAATGTCGTCCCTAGTATAGTGCGTGGAAGACGACGTAGCACGATACATGAGGTGAACAGACTCGTTAAAAGTGCGCATTAAGGGTCACACAGCTGTAGCCATCGTACTCTAC");
        MappedArrowRead mr52(r52, StrandEnum::FORWARD_STRAND, 11, 222, false, false );
        auto result52 = scorer.AddRead(mr52, 1.0);
        ArrowRead r53 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/10405_10514 RQ=0.848","AACGCACCCAGTCGGTGACGAGTGGCAGAGCGATCTATACGCGCTGGTATATTAGTAAGGTGATCAGAGGCTTGCTAGAGGGACTAGTTTAGCCTTTCTTCTCTCGATC");
        MappedArrowRead mr53(r53, StrandEnum::REVERSE_STRAND, 0, 83, false, true );
        auto result53 = scorer.AddRead(mr53, 1.0);
        ArrowRead r54 = MakeRead("m141008_060349_42194_c100704972550000001823137703241586_s1_p0/5/14719_14894 RQ=0.848","TAGTTGACATGGAGGAGTCACACATATTTGATCTCTTGCTACGCTATATTATAATGCGCGCTCCACTCGTGCGTCCGCTCTAGTAGTGCGTTGTGGACCGCGATCGTAGCAGATACATGAGATGACAGATCTTCAGCAGGTGCGCGCAAGTCACAGCTGTAGCATCGTACTCTAC");
        MappedArrowRead mr54(r54, StrandEnum::FORWARD_STRAND, 83, 222, false, false );
        auto result54 = scorer.AddRead(mr54, 1.0);

        Mutation m(MutationType::INSERTION, 202, 'C');
        auto ress = scorer.Score(m);

        std::cout << ress << std::endl;
        return 0;
    }
}

int main() {
    std::cout << "Starting New!!!" << std::endl;
    ConsensusCore::MatrixTester mt;
    for (int i=0; i< 1; i++) {
        mt.TestMutationScorer();
    }
    return 0;
    //return mt.TestMutationScorer() || mt.TestMultiReadScorer();
}
